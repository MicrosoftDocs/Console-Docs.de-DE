---
title: Konsolenhandles
description: Ein Konsolenprozess verwendet Handles, um auf die Eingabe- und Bildschirmpuffer seiner Konsole zuzugreifen, einschließlich der GetStdHandle-, CreateFile- und CreateConsoleScreenBuffer-Funktionen.
author: miniksa
ms.author: miniksa
ms.topic: conceptual
keywords: Konsole, Zeichenmodusanwendungen, Befehlszeilenanwendungen, Terminalanwendungen, Konsolen-API
MS-HAID:
- '\_win32\_console\_handles'
- base.console\_handles
- consoles.console\_handles
MSHAttr:
- PreferredSiteName:MSDN
- PreferredLib:/library/windows/desktop
ms.assetid: dc723046-b3e9-418a-b386-79be411e5ac8
ms.localizationpriority: high
ms.openlocfilehash: 817c902426ac09fdd246f8d1281528ee5dfcab06
ms.sourcegitcommit: 281eb1469f77ae4fb4c67806898e14eac440522a
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 02/14/2021
ms.locfileid: "100358070"
---
# <a name="console-handles"></a><span data-ttu-id="bfd7d-104">Konsolenhandles</span><span class="sxs-lookup"><span data-stu-id="bfd7d-104">Console Handles</span></span>

<span data-ttu-id="bfd7d-105">Ein Konsolenprozess verwendet Handles, um auf die Eingabe- und Bildschirmpuffer seiner Konsole zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="bfd7d-105">A console process uses handles to access the input and screen buffers of its console.</span></span> <span data-ttu-id="bfd7d-106">Ein Prozess kann die Funktion [**GetStdHandle**](getstdhandle.md), [**CreateFile**](/windows/win32/api/fileapi/nf-fileapi-createfilea) oder [**CreateConsoleScreenBuffer**](createconsolescreenbuffer.md) verwenden, um eins dieser Handles zu öffnen.</span><span class="sxs-lookup"><span data-stu-id="bfd7d-106">A process can use the [**GetStdHandle**](getstdhandle.md), [**CreateFile**](/windows/win32/api/fileapi/nf-fileapi-createfilea), or [**CreateConsoleScreenBuffer**](createconsolescreenbuffer.md) function to open one of these handles.</span></span>

<span data-ttu-id="bfd7d-107">Die [**GetStdHandle**](getstdhandle.md)-Funktion bietet einen Mechanismus zum Abrufen der Standardeingabe- (`STDIN`), Standardausgabe- (`STDOUT`) und Standardfehlerhandles (`STDERR`), die einem Prozess zugeordnet sind.</span><span class="sxs-lookup"><span data-stu-id="bfd7d-107">The [**GetStdHandle**](getstdhandle.md) function provides a mechanism for retrieving the standard input (`STDIN`), standard output (`STDOUT`), and standard error (`STDERR`) handles associated with a process.</span></span> <span data-ttu-id="bfd7d-108">Das System erstellt diese Handles während der Konsolenerstellung.</span><span class="sxs-lookup"><span data-stu-id="bfd7d-108">During console creation, the system creates these handles.</span></span> <span data-ttu-id="bfd7d-109">Zu Anfang ist `STDIN` ein Handle zum Eingabepuffer der Konsole, und `STDOUT` und `STDERR` sind Handles des aktiven Bildschirmpuffers der Konsole.</span><span class="sxs-lookup"><span data-stu-id="bfd7d-109">Initially, `STDIN` is a handle to the console's input buffer, and `STDOUT` and `STDERR` are handles of the console's active screen buffer.</span></span> <span data-ttu-id="bfd7d-110">Die Funktion [**SetStdHandle**](setstdhandle.md) kann die Standardhandles jedoch umleiten, indem sie das `STDIN`, `STDOUT` oder `STDERR` zugeordnete Handle ändert.</span><span class="sxs-lookup"><span data-stu-id="bfd7d-110">However, the [**SetStdHandle**](setstdhandle.md) function can redirect the standard handles by changing the handle associated with `STDIN`, `STDOUT`, or `STDERR`.</span></span> <span data-ttu-id="bfd7d-111">Da die Standardhandles des übergeordneten Elements von einem beliebigen untergeordneten Prozess geerbt werden, geben nachfolgende Aufrufe von **GetStdHandle** das umgeleitete Handle zurück.</span><span class="sxs-lookup"><span data-stu-id="bfd7d-111">Because the parent's standard handles are inherited by any child process, subsequent calls to **GetStdHandle** return the redirected handle.</span></span> <span data-ttu-id="bfd7d-112">Ein von **GetStdHandle** zurückgegebenes Handle kann daher auf etwas anderes als Konsolen-E/A verweisen.</span><span class="sxs-lookup"><span data-stu-id="bfd7d-112">A handle returned by **GetStdHandle** may, therefore, refer to something other than console I/O.</span></span> <span data-ttu-id="bfd7d-113">Beispielsweise kann ein übergeordneter Prozess vor dem Erstellen eines untergeordneten Prozesses **SetStdHandle** verwenden, um ein Pipehandle als das `STDIN`-Handle festzulegen, das vom untergeordneten Prozess geerbt wird.</span><span class="sxs-lookup"><span data-stu-id="bfd7d-113">For example, before creating a child process, a parent process can use **SetStdHandle** to set a pipe handle to be the `STDIN` handle that is inherited by the child process.</span></span> <span data-ttu-id="bfd7d-114">Wenn der untergeordnete Prozess **GetStdHandle** aufruft, erhält er das Pipehandle.</span><span class="sxs-lookup"><span data-stu-id="bfd7d-114">When the child process calls **GetStdHandle**, it gets the pipe handle.</span></span> <span data-ttu-id="bfd7d-115">Dies bedeutet, dass der übergeordnete Prozess die Standardhandles des untergeordneten Prozesses kontrollieren kann.</span><span class="sxs-lookup"><span data-stu-id="bfd7d-115">This means that the parent process can control the standard handles of the child process.</span></span> <span data-ttu-id="bfd7d-116">Die von **GetStdHandle** zurückgegebenen Handles verfügen über `GENERIC_READ | GENERIC_WRITE`-Zugriff, es sei denn, **SetStdHandle** wurde verwendet, um für das Standardhandle geringere Zugriffsrechte festzulegen.</span><span class="sxs-lookup"><span data-stu-id="bfd7d-116">The handles returned by **GetStdHandle** have `GENERIC_READ | GENERIC_WRITE` access unless **SetStdHandle** has been used to set the standard handle to have lesser access.</span></span>

<span data-ttu-id="bfd7d-117">Die Werte der von [**GetStdHandle**](getstdhandle.md) zurückgegebenen Handles sind nicht 0, 1 und 2, daher können die vordefinierten Standard-Streamkonstanten in Stdio.h (`STDIN`, `STDOUT` und `STDERR`) nicht in Funktionen verwendet werden, die ein Konsolenhandle erfordern.</span><span class="sxs-lookup"><span data-stu-id="bfd7d-117">The value of the handles returned by [**GetStdHandle**](getstdhandle.md) are not 0, 1, and 2, so the standard predefined stream constants in Stdio.h (`STDIN`, `STDOUT`, and `STDERR`) cannot be used in functions that require a console handle.</span></span>

<span data-ttu-id="bfd7d-118">Die [**CreateFile**](/windows/win32/api/fileapi/nf-fileapi-createfilea)-Funktion ermöglicht es einem Prozess, ein Handle zum Eingabepuffer und dem aktiven Bildschirmpuffer seiner Konsole abzurufen, selbst wenn `STDIN` und `STDOUT` umgeleitet wurden.</span><span class="sxs-lookup"><span data-stu-id="bfd7d-118">The [**CreateFile**](/windows/win32/api/fileapi/nf-fileapi-createfilea) function enables a process to get a handle to its console's input buffer and active screen buffer, even if `STDIN` and `STDOUT` have been redirected.</span></span> <span data-ttu-id="bfd7d-119">Geben Sie den `CONIN$`-Wert in einem Aufruf von **CreateFile** an, um ein Handle zum Eingabepuffer einer Konsole zu öffnen.</span><span class="sxs-lookup"><span data-stu-id="bfd7d-119">To open a handle to a console's input buffer, specify the `CONIN$` value in a call to **CreateFile**.</span></span> <span data-ttu-id="bfd7d-120">Geben Sie den `CONOUT$`-Wert in einem Aufruf von **CreateFile** an, um ein Handle zum aktiven Bildschirmpuffer einer Konsole zu öffnen.</span><span class="sxs-lookup"><span data-stu-id="bfd7d-120">Specify the `CONOUT$` value in a call to **CreateFile** to open a handle to a console's active screen buffer.</span></span> <span data-ttu-id="bfd7d-121">Mithilfe von **CreateFile** können Sie den Lese-/Schreibzugriff des von der Funktion zurückgegebenen Handles angeben.</span><span class="sxs-lookup"><span data-stu-id="bfd7d-121">**CreateFile** enables you to specify the read/write access of the handle that it returns.</span></span>

<span data-ttu-id="bfd7d-122">Die Funktion [**CreateConsoleScreenBuffer**](createconsolescreenbuffer.md) erstellt einen neuen Bildschirmpuffer und gibt ein Handle zurück.</span><span class="sxs-lookup"><span data-stu-id="bfd7d-122">The [**CreateConsoleScreenBuffer**](createconsolescreenbuffer.md) function creates a new screen buffer and returns a handle.</span></span> <span data-ttu-id="bfd7d-123">Dieses Handle kann in jeder Funktion verwendet werden, die ein Handle zur Konsolenausgabe akzeptiert.</span><span class="sxs-lookup"><span data-stu-id="bfd7d-123">This handle can be used in any function that accepts a handle to console output.</span></span> <span data-ttu-id="bfd7d-124">Der neue Bildschirmpuffer ist nicht aktiv (wird nicht angezeigt), bis sein Handle in einem Aufruf der Funktion [**SetConsoleActiveScreenBuffer**](setconsoleactivescreenbuffer.md) angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="bfd7d-124">The new screen buffer is not active (displayed) until its handle is specified in a call to the [**SetConsoleActiveScreenBuffer**](setconsoleactivescreenbuffer.md) function.</span></span> <span data-ttu-id="bfd7d-125">Beachten Sie, dass ein Wechsel des aktiven Bildschirmpuffers sich nicht auf das von [**GetStdHandle**](getstdhandle.md) zurückgegebene Handle auswirkt.</span><span class="sxs-lookup"><span data-stu-id="bfd7d-125">Note that changing the active screen buffer does not affect the handle returned by [**GetStdHandle**](getstdhandle.md).</span></span> <span data-ttu-id="bfd7d-126">Analog dazu wirkt sich die Verwendung von [**SetStdHandle**](setstdhandle.md) zum Ändern des `STDOUT`-Handles nicht auf den aktiven Bildschirmpuffer aus.</span><span class="sxs-lookup"><span data-stu-id="bfd7d-126">Similarly, using [**SetStdHandle**](setstdhandle.md) to change the `STDOUT` handle does not affect the active screen buffer.</span></span>

<span data-ttu-id="bfd7d-127">Die von [**CreateFile**](/windows/win32/api/fileapi/nf-fileapi-createfilea) und [**CreateConsoleScreenBuffer**](createconsolescreenbuffer.md) zurückgegebenen Konsolenhandles können in jeder der Konsolenfunktionen verwendet werden, die ein Handle zum Eingabepuffer oder dem Bildschirmpuffer einer Konsole erfordern.</span><span class="sxs-lookup"><span data-stu-id="bfd7d-127">Console handles returned by [**CreateFile**](/windows/win32/api/fileapi/nf-fileapi-createfilea) and [**CreateConsoleScreenBuffer**](createconsolescreenbuffer.md) can be used in any of the console functions that require a handle to a console's input buffer or of a console screen buffer.</span></span> <span data-ttu-id="bfd7d-128">Handles, die von [**GetStdHandle**](getstdhandle.md) zurückgegeben werden, können von den Konsolenfunktionen verwendet werden, wenn sie nicht umgeleitet wurden, um auf etwas anderes als die Konsolen-E/A zu verweisen.</span><span class="sxs-lookup"><span data-stu-id="bfd7d-128">Handles returned by [**GetStdHandle**](getstdhandle.md) can be used by the console functions if they have not been redirected to refer to something other than console I/O.</span></span> <span data-ttu-id="bfd7d-129">Wenn ein Standardhandle jedoch umgeleitet wurde, um auf eine Datei oder eine Pipe zu verweisen, kann das Handle nur von den [**ReadFile**](/windows/win32/api/fileapi/nf-fileapi-readfile)- und [**WriteFile**](/windows/win32/api/fileapi/nf-fileapi-writefile)-Funktionen verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="bfd7d-129">If a standard handle has been redirected to refer to a file or a pipe, however, the handle can only be used by the [**ReadFile**](/windows/win32/api/fileapi/nf-fileapi-readfile) and [**WriteFile**](/windows/win32/api/fileapi/nf-fileapi-writefile) functions.</span></span> <span data-ttu-id="bfd7d-130">[**GetFileType**](/windows/win32/api/fileapi/nf-fileapi-getfiletype) kann verwendet werden, um den Gerätetyp zu bestimmen, auf den das Handle verweist.</span><span class="sxs-lookup"><span data-stu-id="bfd7d-130">[**GetFileType**](/windows/win32/api/fileapi/nf-fileapi-getfiletype) can assist in determining what device type the handle refers to.</span></span> <span data-ttu-id="bfd7d-131">Ein Konsolenhandle wird als `FILE_TYPE_CHAR` dargestellt.</span><span class="sxs-lookup"><span data-stu-id="bfd7d-131">A console handle presents as `FILE_TYPE_CHAR`.</span></span>

<span data-ttu-id="bfd7d-132">Ein Prozess kann die [**DuplicateHandle**](/windows/win32/api/handleapi/nf-handleapi-duplicatehandle)-Funktion verwenden, um ein Duplikat eines Konsolenhandles zu erstellen, das gegenüber dem ursprünglichen Handle abweichende Zugriffsrechte oder eine andere Vererbung aufweist.</span><span class="sxs-lookup"><span data-stu-id="bfd7d-132">A process can use the [**DuplicateHandle**](/windows/win32/api/handleapi/nf-handleapi-duplicatehandle) function to create a duplicate console handle that has different access or inheritability from the original handle.</span></span> <span data-ttu-id="bfd7d-133">Beachten Sie aber, dass ein Prozess ein Duplikat eines Konsolenhandles nur für den eigenen Gebrauch erstellen kann.</span><span class="sxs-lookup"><span data-stu-id="bfd7d-133">Note, however, that a process can create a duplicate console handle only for its own use.</span></span> <span data-ttu-id="bfd7d-134">Dieses Verhalten unterscheidet sich von anderen Handletypen (etwa für Datei-, Pipe- oder Mutexobjekte), für die **DuplicateHandle** ein Duplikat erstellen kann, das für andere Prozesse gültig ist.</span><span class="sxs-lookup"><span data-stu-id="bfd7d-134">This differs from other handle types (such as file, pipe, or mutex objects), for which **DuplicateHandle** can create a duplicate that is valid for a different process.</span></span>
<span data-ttu-id="bfd7d-135">Der Zugriff auf eine Konsole muss während der [Erstellung](creation-of-a-console.md) des anderen Prozesse freigegeben werden oder von dem anderen Prozess mithilfe des [**AttachConsole**](attachconsole.md)-Mechanismus angefordert werden.</span><span class="sxs-lookup"><span data-stu-id="bfd7d-135">Access to a console must be shared during [creation](creation-of-a-console.md) of the other process or may be requested by the other process through the [**AttachConsole**](attachconsole.md) mechanism.</span></span>

<span data-ttu-id="bfd7d-136">Zum Schließen eines Konsolenhandles kann ein Prozess die [**CloseHandle**](/windows/win32/api/handleapi/nf-handleapi-closehandle)-Funktion verwenden.</span><span class="sxs-lookup"><span data-stu-id="bfd7d-136">To close a console handle, a process can use the [**CloseHandle**](/windows/win32/api/handleapi/nf-handleapi-closehandle) function.</span></span>